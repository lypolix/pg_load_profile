# PostgreSQL Load Profiler

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è PostgreSQL —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏ –ø–æ —Ç—é–Ω–∏–Ω–≥—É, –∞ —Ç–∞–∫–∂–µ –º–æ–¥—É–ª—å ML –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏—Ö.

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

¬´–ê–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏¬ª:
- –¢–∏–ø–∏–∑–∏—Ä—É–µ—Ç 8+ –ø—Ä–æ—Ñ–∏–ª–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (OLTP, OLAP, IoT, locks, reporting, ETL, cold, mixed).
- –°–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ DB Time (ASH/Committed), CPU/IO/locks, TPS/QPS/latency.
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ `postgresql.conf` –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- **–°–£–ë–î**: PostgreSQL 15+.
- **–ù–∞–≥—Ä—É–∑–∫–∞**: SQL-—Å–∫—Ä–∏–ø—Ç—ã (`init.sql`, `olap.sql`, `iot.sql`, `locks.sql`, `reporting.sql`, `etl.sql`, `cold.sql`, `mixed.sql`) –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø—Ä–æ—Ñ–∏–ª–µ–π.
- **–ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã PostgreSQL**:
  - `psql` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ SQL-—Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ —Ä—É—á–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
  - `COPY`/`\copy` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ bulk-–≤–≤–æ–¥–∞ –≤ ETL-—Å—Ü–µ–Ω–∞—Ä–∏—è—Ö.
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –º–µ—Ç—Ä–∏–∫ –≤–Ω—É—Ç—Ä–∏ PostgreSQL**:
  - `pg_stat_statements` ‚Äî –≤—Ä–µ–º—è –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã–∑–æ–≤–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤.
  - `pg_stat_activity` ‚Äî –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ –∏ –∑–∞–ø—Ä–æ—Å—ã.
  - `pg_locks` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞—Ö.
  - `pg_stat_database`, `pg_stat_io`, `pg_stat_bgwriter` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, IO, —á–µ–∫–ø–æ–∏–Ω—Ç–∞–º.
- **–í–Ω–µ—à–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã**:
  - `pg_top`, `pg_activity` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏) –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è CPU/IO/locks –∏ —Ç–µ–∫—É—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
- **–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å (Go/Python)**:
  - HTTP API:
    - `/config/apply?preset=<profile>` ‚Äî –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (`oltp`, `olap`, `write_heavy`, `high_concurrency`, `reporting`, `etl`, `cold`, `mixed`).
    - `/load/start?scenario=<scenario>` ‚Äî –∑–∞–ø—É—Å–∫ —Å—Ü–µ–Ω–∞—Ä–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ (`oltp`, `olap`, `iot`, `locks`, `reporting`, `etl`, `cold`, `mixed`, `init`).
    - `/diagnosis` ‚Äî –≤–æ–∑–≤—Ä–∞—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
  - –°–±–æ—Ä –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∑–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ç–µ—Å—Ç–∞, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ JSON.

## üìä –ü—Ä–æ—Ñ–∏–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–µ–∞–ª—å–Ω—ã–º –±–∏–∑–Ω–µ—Å-–∫–µ–π—Å–∞–º:

- **IDLE**  
  - –°–£–ë–î –ø—Ä–æ—Å—Ç–∞–∏–≤–∞–µ—Ç, `tps`/`qps` ‚âà 0, —Ä–µ—Å—É—Ä—Å—ã –ø–æ—á—Ç–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.
- **CLASSIC OLTP**  
  - –ë–∞–Ω–∫–∏–Ω–≥, –ø–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã, –±–∏—Ä–∂–∞, –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ.
  - –ú–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π `INSERT/UPDATE/SELECT`, –≤–∞–∂–Ω–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å.
- **OLAP (ANALYTICAL)**  
  - BI, –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞, data mining.
  - –ù–µ–±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—è–∂—ë–ª—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å JOIN, –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏, –ø–æ–ª–Ω—ã–º–∏ —Å–∫–∞–Ω–∞–º–∏.
- **WRITE-HEAVY (IoT)**  
  - –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π, –ø–æ—Ç–æ–∫ INSERT.
  - –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å, –ø–æ—á—Ç–∏ –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö —á—Ç–µ–Ω–∏–π.
- **HIGH CONCURRENCY / LOCKS**  
  - –ü–∏–∫–æ–≤—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –≤ e-commerce –∏ —Ñ–∏–Ω—Å–µ—Ä–≤–∏—Å–∞—Ö.
  - –í—ã—Å–æ–∫–∞—è –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Å—Ç—Ä–æ–∫–∏/—Ä–µ—Å—É—Ä—Å—ã, –º–Ω–æ–≥–æ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫.
- **READ-HEAVY / REPORTING**  
  - –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç—å, –¥–∞—à–±–æ—Ä–¥—ã.
  - –ú–∞—Å—Å–æ–≤–æ–µ —á—Ç–µ–Ω–∏–µ ¬´–≥–æ—Ä—è—á–∏—Ö¬ª –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∫—ç—à–∞, –º–∏–Ω–∏–º—É–º –∑–∞–ø–∏—Å–∏.
- **BULK ETL / BATCH LOAD**  
  - –ù–æ—á–Ω—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏, –≤–∏—Ç—Ä–∏–Ω—ã, –º–∏–≥—Ä–∞—Ü–∏–∏.
  - –ö—Ä—É–ø–Ω—ã–µ batch-–æ–ø–µ—Ä–∞—Ü–∏–∏, COPY, –º–∞—Å—Å–æ–≤—ã–µ –≤—Å—Ç–∞–≤–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
- **COLD / ARCHIVE-SCAN**  
  - –ê—Ä—Ö–∏–≤—ã, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ, –±—ç–∫–∞–ø—ã.
  - –†–µ–¥–∫–∏–µ, –Ω–æ —Ç—è–∂—ë–ª—ã–µ seq-scan –ø–æ –±–æ–ª—å—à–∏–º —Ç–∞–±–ª–∏—Ü–∞–º.
- **MIXED / HTAP**  
  - CRM/ERP, —Å–∏—Å—Ç–µ–º—ã, –≥–¥–µ OLTP –∏ OLAP –∂–∏–≤—É—Ç –Ω–∞ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.
  - –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã—Ö –∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫.


## ü§ñ ML-–º–æ–¥—É–ª—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏

–í –ø—Ä–æ–µ–∫—Ç –≤—Å—Ç—Ä–æ–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π ML-–º–æ–¥—É–ª—å, –∫–æ—Ç–æ—Ä—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ –±–∞–∑e –º–µ—Ç—Ä–∏–∫ PostgreSQL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–æ–¥–µ–ª–∏ CatBoostClassifier.

### –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- Python + CatBoostClassifier –¥–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ (init, oltp, olap, iot, locks, reporting, etl, cold, mixed) –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º —Ä–∞–±–æ—Ç—ã –ë–î.  
- –ü–∞–∫–µ—Ç—ã pandas –∏ NumPy –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –≤–∫–ª—é—á–∞—è —á–∏—Å–ª–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏.  
- scikit-learn (train_test_split, classification_report, accuracy_score) –¥–ª—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏.  
- FastAPI + Pydantic –¥–ª—è REST API —Å–µ—Ä–≤–∏—Å–∞ –æ–Ω–ª–∞–π–Ω‚Äë–∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ JSON‚Äë–æ—Ç–≤–µ—Ç—ã —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏). 
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π logging –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ (feature columns, categorical features, class names) –≤ JSON‚Äë—Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ–≥–æ –¥–µ–ø–ª–æ—è. 

### –û–±—É—á–µ–Ω–∏–µ –∏ –¥–∞–Ω–Ω—ã–µ

- –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∏–∑ –º–∞—Å—Å–∏–≤–∞ JSON‚Äë–æ–±—ä–µ–∫—Ç–æ–≤, –≥–¥–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–∞–≥—Ä—É–∑–∫–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω –±–ª–æ–∫ `diagnosis.metrics` –∏ `ground_truth` (load_scenario + active_config). 
- –î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–ø–∏—Å–∏ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏: db_time_total, db_time_committed, cpu_time, io_time, lock_time, cpu_percent, io_percent, lock_percent, tps, qps, avg_query_latency_ms, rollback_rate, total_commits, total_rollbacks, total_calls –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ active_config. 
- –¶–µ–ª—å—é (target) –≤ –≤–∞—Ä–∏–∞–Ω—Ç–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ —è–≤–ª—è–µ—Ç—Å—è `loadscenario`, —Ç–æ –µ—Å—Ç—å —Ç–∏–ø —Å—Ü–µ–Ω–∞—Ä–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏, –∞ –∫–æ–Ω—Ñ–∏–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫.   
- –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ –¥–µ–ª—è—Ç—Å—è –Ω–∞ train/test, –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –¥–æ 1000 –∏—Ç–µ—Ä–∞—Ü–∏–π —Å MultiClass‚Äëloss –∏ early stopping, –¥–æ—Å—Ç–∏–≥–∞—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∏–¥–µ–∞–ª—å–Ω–æ–π —Ç–æ—á–Ω–æ—Å—Ç–∏ (accuracy ‚âà 1.0 –Ω–∞ —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –∏–∑ 9 –∫–ª–∞—Å—Å–æ–≤ –ø–æ 160 –ø—Ä–∏–º–µ—Ä–æ–≤). 
- –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –±–∏–Ω–∞—Ä–Ω—ã–π —Ñ–∞–π–ª –º–æ–¥–µ–ª–∏ CatBoost –∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π JSON —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –∏ —Å–ø–∏—Å–∫–∞ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –∑–∞–≥—Ä—É–∑–∫–∏ –≤ API. 

### –õ–æ–≥–∏–∫–∞ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ API

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–∏—Å–∞ –º–æ–¥–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤–º–µ—Å—Ç–µ —Å–æ —Å–ø–∏—Å–∫–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ –∏ –∏–º–µ–Ω –∫–ª–∞—Å—Å–æ–≤; –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ JSON‚Äë–º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –æ–Ω–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∏–∑ —Å–∞–º–æ–π –º–æ–¥–µ–ª–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∑–∞–Ω–æ–≤–æ. 
- –í—Ö–æ–¥–Ω–æ–π –∑–∞–ø—Ä–æ—Å –∫ API –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –æ–±—ä–µ–∫—Ç —Å –±–ª–æ–∫–æ–º –º–µ—Ç—Ä–∏–∫ (–≤—Å–µ —Ç–µ –∂–µ –ø–æ–ª—è, —á—Ç–æ –∏ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏) –∏ —Å—Ç—Ä–æ–∫–æ–≤—ã–º –ø–æ–ª–µ–º active_config; FastAPI –∏ Pydantic –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ç–∏–ø—ã –∏ —Å–æ–±–∏—Ä–∞—é—Ç –∏—Ö –≤ DataFrame.
- –ü–µ—Ä–µ–¥ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –∞–∫—Ç–∏–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–º—É —Ç–∏–ø—É, –¥–∞–ª–µ–µ CatBoost –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∞—Å—Å (—Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏) –∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º. 

- –í –æ—Ç–≤–µ—Ç–µ API –∫–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç:
  - `predicted_scenario` ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–∞–≥—Ä—É–∑–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `oltp`, `olap`, `iot` –∏ —Ç.–¥.);  
  - `confidence` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–æ–º—É –∫–ª–∞—Å—Å—É;  
  - `probabilities` ‚Äî –ø–æ–ª–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –≤—Å–µ–º —Å—Ü–µ–Ω–∞—Ä–∏—è–º;  
  - `status` ‚Äî —Ñ–ª–∞–≥ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ (`success`). [file:124]  
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∏—Ç—å —Å–ª—É–∂–µ–±–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –º–æ–¥–µ–ª–∏ (—Ç–∏–ø—ã, —Å–ø–∏—Å–æ–∫ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–ª–∞—Å—Å—ã) –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥–µ–ª—å –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞.



## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ PostgreSQL

–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –Ω–∞–≥—Ä—É–∑–∫–∏ –µ—Å—Ç—å –ø—Ä–µ—Å–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`active_config`), –∑–∞–¥–∞—é—â–∏–π –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã PostgreSQL. –ü—Ä–∏–º–µ—Ä—ã:

- **OLTP –ø—Ä–æ—Ñ–∏–ª—å**:
  - `temp_file_limit`: –æ–∫–æ–ª–æ 5% –æ—Ç `/pg_data`.
  - `checkpoint_timeout`: ~900s.
  - `min_wal_size`: ~2048MB.
  - `max_wal_size`: ~8192MB.
  - `max_parallel_workers_per_gather`: 0.
  - `max_parallel_workers`: 0.
  - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: `synchronous_commit=on`, —É–º–µ—Ä–µ–Ω–Ω—ã–π `shared_buffers`, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π `work_mem`.

- **OLAP –ø—Ä–æ—Ñ–∏–ª—å**:
  - `temp_file_limit`: –æ–∫–æ–ª–æ 10% –æ—Ç `/pg_data`.
  - `checkpoint_timeout`: ~1800s.
  - `min_wal_size`: ~4096MB.
  - `max_wal_size`: ~16384MB.
  - `max_parallel_workers_per_gather`: CPU/4.
  - `max_parallel_workers`: CPU/2.
  - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π `work_mem`, –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º.

- **WRITE-HEAVY / IoT**:
  - –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π `max_wal_size` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 8GB+).
  - –ë–æ–ª–µ–µ —Ä–µ–¥–∫–∏–µ checkpoint‚Äô—ã.
  - –í–æ–∑–º–æ–∂–Ω–æ `synchronous_commit=off` –ø—Ä–∏ –ø—Ä–∏–µ–º–ª–µ–º–æ–º —Ä–∏—Å–∫–µ.

- **REPORTING / READ-HEAVY**:
  - –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ `shared_buffers` –∏ –∫—ç—à.
  - –£–º–µ—Ä–µ–Ω–Ω—ã–π `work_mem`.

- **ETL / BULK LOAD**:
  - –î–ª–∏–Ω–Ω—ã–π `checkpoint_timeout` (–¥–æ 1 —á–∞—Å–∞).
  - –û—á–µ–Ω—å –±–æ–ª—å—à–æ–π WAL (`max_wal_size` 10GB –∏ –±–æ–ª–µ–µ).
  - `work_mem` –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ batch-–æ–ø–µ—Ä–∞—Ü–∏–∏.

- **COLD / ARCHIVE-SCAN**:
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ seq-scan (`max_parallel_workers_per_gather`).
  - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ —Ö–æ–ª–æ–¥–Ω—ã–º–∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏.

## üöÄ –°—Ü–µ–Ω–∞—Ä–∏–∏ –Ω–∞–≥—Ä—É–∑–∫–∏

–°—Ü–µ–Ω–∞—Ä–∏–∏ –∑–∞–¥–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `load_scenario` –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã SQL-—Å–∫—Ä–∏–ø—Ç–∞–º–∏:

- `init` ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å—Ö–µ–º—ã –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü, –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ).
- `oltp` ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å `INSERT/UPDATE/SELECT`.
- `olap` ‚Äî —Ç—è–∂—ë–ª—ã–µ –∑–∞–ø—Ä–æ—Å—ã —Å JOIN, –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏, —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –ø–æ –∫—Ä—É–ø–Ω—ã–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º.
- `iot` ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –ø–æ—Ç–æ–∫ `INSERT` (–¥–∞–Ω–Ω—ã–µ —Å–µ–Ω—Å–æ—Ä–æ–≤/–ª–æ–≥–æ–≤).
- `locks` ‚Äî –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (–∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ UPDATE/SELECT).
- `reporting` ‚Äî –∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ã–µ `SELECT` –ø–æ ¬´–≥–æ—Ä—è—á–∏–º¬ª –¥–∞–Ω–Ω—ã–º/–∞–≥—Ä–µ–≥–∞—Ç–∞–º.
- `etl` ‚Äî bulk-–æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (—á–∞—Å—Ç–æ —á–µ—Ä–µ–∑ COPY).
- `cold` ‚Äî seq-scan –∏ –≤—ã–±–æ—Ä–∫–∏ –ø–æ –±–æ–ª—å—à–∏–º –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º.
- `mixed` ‚Äî –∫–æ–º–±–∏–Ω–∞—Ü–∏—è OLTP/OLAP/–¥—Ä—É–≥–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π.

–ö–æ–º–±–∏–Ω–∞—Ü–∏–∏: 8 —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ √ó 8 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π = 64 —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞.

## üìà –ú–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–±–∏—Ä–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

–ö–∞–∂–¥—ã–π –∑–∞–ø—É—Å–∫ —Å—Ü–µ–Ω–∞—Ä–∏–π√ó–∫–æ–Ω—Ñ–∏–≥ –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç `diagnosis` —Å –ø–æ–ª–µ–º `metrics`, –≤–∫–ª—é—á–∞—é—â–∏–º:

- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:
  - `db_time_total` ‚Äî —Å—É–º–º–∞—Ä–Ω–æ–µ –≤—Ä–µ–º—è –≤ –ë–î.
  - `db_time_committed` ‚Äî –≤—Ä–µ–º—è –ø–æ –∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã–º –æ–ø–µ—Ä–∞—Ü–∏—è–º (–¥–ª—è ASH/Committed).
  - `cpu_time`, `io_time`, `lock_time` ‚Äî —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ —Ç–∏–ø–∞–º –æ–∂–∏–¥–∞–Ω–∏–π.
  - –ü—Ä–æ–∏–∑–≤–æ–¥–Ω—ã–µ: `cpu_percent`, `io_percent`, `lock_percent`.

- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
  - `tps` ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É.
  - `qps` ‚Äî –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É.
  - `avg_query_latency_ms` ‚Äî —Å—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.
  - `rollback_rate` ‚Äî –¥–æ–ª—è –æ—Ç–∫–∞—Ç–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.

- –°—á—ë—Ç—á–∏–∫–∏:
  - `total_commits`, `total_rollbacks`, `total_calls`.

–≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è PostgreSQL –∏ –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è —Å–µ—Ä–≤–∏—Å–æ–º –≤ JSON.

## üß† –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

–ù–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Ç—Ä–∏–∫ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (—Å—Ü–µ–Ω–∞—Ä–∏–π + –∞–∫—Ç–∏–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥) —Å–∏—Å—Ç–µ–º–∞ —Å—Ç—Ä–æ–∏—Ç –æ–±—ä–µ–∫—Ç `diagnosis`:

```
{
"profile": "CLASSIC OLTP",
"description": "–ë–∞–Ω–∫–∏–Ω–≥, –ë–∏—Ä–∂–∞. –ö–æ—Ä–æ—Ç–∫–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.",
"confidence": "High",
"metrics": {
"db_time_total": 12.5,
"db_time_committed": 10.5,
"cpu_time": 10.5,
"io_time": 1.0,
"lock_time": 1.0,
"cpu_percent": 84.0,
"io_percent": 8.0,
"lock_percent": 8.0,
"tps": 2500.0,
"qps": 5000.0,
"avg_query_latency_ms": 0.4,
"rollback_rate": 0.1,
"total_commits": 150000,
"total_rollbacks": 10,
"total_calls": 300000
},
"tuning_recommendations": {
"shared_buffers": "128MB",
"work_mem": "4MB",
"max_wal_size": "1GB",
"checkpoint_timeout": "15min",
"synchronous_commit": "on",
"max_parallel_workers_per_gather": "0",
"deadlock_timeout": "1s"
},
"reasoning": "Score: 4.5"
}
```

–°–∏—Å—Ç–µ–º–∞:
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å (`profile`) –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ (CPU/IO/locks), DB Time, TPS/QPS, latency, rollback‚Äô–æ–≤.
- –î–∞—ë—Ç —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ (`description`) –∏ —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (`confidence`).
- –ü—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –Ω–∞–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (`tuning_recommendations`), –∫–æ—Ç–æ—Ä—ã–µ –ª—É—á—à–µ –≤—Å–µ–≥–æ –ø–æ–¥—Ö–æ–¥—è—Ç –ø–æ–¥ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏.


## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–µ–∫—Ç

- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–≥–æ–Ω —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ PostgreSQL.
- –°–Ω–∏–º–∞–µ—Ç –∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.
- –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –Ω–∞–≥—Ä—É–∑–∫–∏ (OLTP, OLAP, IoT, ETL, –∏ —Ç.–¥.).
- –ü–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `postgresql.conf` –º–µ–Ω—è—Ç—å –ø–æ–¥ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å.
